# GTC-movie-from-snapshots


This program in matlab that reads in GTC snapshot output files and making movies using the data. If you have any comments/questions, please contact me at *zhixuanw@uci.edu*.

The snapmovie.m uses VideoWriter Class by Matlab, which is only supported since Matlab 2010b. 
Please Check your Matlab version before using this program


## Files

### readallsnap.m
    
    function A=readallsnap(target_dir, output)

This function reads all the snapshots output generated by on GTC run, returns a matlab structure containing all the information. 

* "target_dir" (*optional*) is the target directory you want to read.
    * `a` or `a/` work the same as reading all `snap*.out` in the `a/` directory.
    * If not specified, the default value is `./`

* "output" (*optional*) is a switch (`0` or `1`) whether you want output during the reading
    * Sometimes the reading would take several minuites and you may want to monitor the process to make sure it is running but not freezing. 
    * If not specified, the default value is `output=0`


### snap2dmovie.m

    function snap2dmovie(snapdata, filename, nfield, speed, framerate, framequality, outerxsize, outerzsize)

This function generates a 2-D snapshot movie from matlab structure (from `readallsnap.m`), returns nothing

* "snapdata" (*required*) is a structure generated by `readallsnap.m`
* "filename" (*optional*) is the name of the output file.
    * The supported file extensions are `.avi`, `.mj2`, `.mp4` and `.m4v`. For details please check [the `VideoWriter` documentation](http://www.mathworks.com/help/matlab/ref/videowriter-class.html)
    * If not specified, the output file will be `GTCsnapmovie.avi`.
* "nfield" (*optional*) is the field you want to diagonose. The default fields are: 
    * 1. phi          2. apara           3. fluidne
    * If not specified, the default value is `nfield=1`.
* "speed" (*optional*) is the speed your movie advances in snapshots. 
    * For example, `speed=2` will generate one frame from every 2 snapshot files
    * If not specified, `speed = 1` by default
* "framerate" and "framequality" (*optional*) indicates the `FrameRate` and `Quality` properties of `videoWriter` respectively.
    * Details can be found in [the `VideoWriter` documentation](http://www.mathworks.com/help/matlab/ref/videowriter-class.html)
    * If not specified, `framerate = 10` and `framequality = 75` by default
* "outerxsize" and "outerzsize" (*optional*) indicates the width and height of each frame respectively
    * If not specified, `outerxsize = 1200` and `outerzsize = 800` by default

### snap1dmovie.m

    function snap1dmovie(snapdata, filename, nfield, m, speed, framerate, framequality, outerxsize, outerzsize)

This function generates a movie of 1-D RMS value (and the amplitude of several poloidal harmonics) from matlab structure (from `readallsnap.m`), returns nothing

* Similar arguments as the arguments in `snap2dmovie.m` have the same functionality
* "m" (*optional*) is an array of the poloidal harmonics you want to analyse in the movie
    * This argument should be an array, even if there is only one element
    * If not specified, first calculate `m_max`, the `m` that has the largest amplitude in the center of the radius in the last snapshot, and then choose `m=[m_max-2: m_max+2]`

## Usage Example

    >> snap = readallsnap; % read in all the snapshot outputs from GTC
    Now processing snap00001.out
    Now processing snap00050.out
    Now processing snap00100.out
    Now processing snap00150.out
    Now processing snap00200.out
    ...
    >> % generate the apara snapshot movie with FrameRate=5, Quality = 100, Width=1000, Height=600 in 'test.avi'
    >> snap2dmovie(snap, 'test.avi', 2, 1, 5, 100, 1000, 600) 
     

## Additional Comments: 

* Though it is mainly written for the use of this structure in generating movie in `snap2dmovie.m`, 
you can easily plot any data from snapshot outputs once you read them in with this tool.

* In the right two panels you can easily put any plot you want there. For example, ion density profile can be plotted in order to check profile flattening, etc. 

* I have not implemented the functionality to plot the particle distribution from GTC snapshots yet. Probably one day I will update it. 

* It will be greatly appreciated if you want to contribute. Please feel free to contact me at *zhixuanw@uci.edu*

## License:

This is a free-software available under GNU General Public License Version 3 (see LICENSE.md). 
